
var sgwAjax=Array(8);function sgwAjaxStart(url,scroll){try{sgwAjax[0]=new XMLHttpRequest();}catch(trymicrosoft){try{sgwAjax[0]=new ActiveXObject("Msxml2.XMLHTTP");}catch(othermicrosoft){try{sgwAjax[0]=new ActiveXObject("Microsoft.XMLHTTP");}catch(failed){sgwAjax[0]=null;}}}if(!sgwAjax[0]){alert('Error creating request object - cannot retrieve any message data!');return;}sgwAjax[1]=null;sgwAjax[2]=url;sgwAjax[6]='-1/-1/'+scroll;sgwQuery(1);}function sgwQuery(res){if(sgwAjax[1])clearTimeout(sgwAjax[1]);if(res)sgwAjax[5]=0;if(sgwAjax[3]){if(sgwAjax[5]<=3000)sgwAjax[5]+=500;}else{if(sgwAjax[5]<=10000)sgwAjax[5]+=500;}sgwAjax[1]=setTimeout('sgwQuery(0)',sgwAjax[5]);if(sgwAjax[0].readyState!=3){var d=new Date();sgwAjax[0].open('GET',sgwAjax[2]+'&c='+sgwAjax[6]+'&u='+d.getTime(),true);sgwAjax[0].onreadystatechange=sgwGetData;sgwAjax[0].send(null);}}function sgwGetData(){if(sgwAjax[0].readyState==4){if(sgwAjax[0].status==200){var recs=sgwAjax[0].responseText.split('\n');var top=null;var data=0;var o;for(var i=0;i<recs.length-1;i++){var n=recs[i].slice(1,2);if(n=='6')o=document.getElementById('sgwCmd');else
o=document.getElementById('sgwMsg');switch(recs[i].slice(0,1)){case'0':o.innerHTML=' ';break;case'1':var txt=document.createElement('div');txt.innerHTML=recs[i].slice(2);var r=o.appendChild(txt);if(!top)top=r;data=1;break;case'2':var txt=document.createElement('div');txt.innerHTML=recs[i].slice(2);if(!top){for(top=o.firstChild;top;top=top.nextSibling){if(top.nodeType===1)break;}}top=o.insertBefore(txt,top);data=1;break;case'3':sgwAjax[6]=recs[i].slice(2);break;default:break;}}if(data){var s=sgwAjax[6].toString();var c=s.split('/');if(c[2]==2)o.scrollTop=o.scrollHeight;else{o=document.getElementById('sgwCmd');top=document.getElementById('sgwCmdPos');if(top.value>-1&&o.scrollHeight>top.value)o.scrollTop=top.value;o=document.getElementById('sgwMsg');top=document.getElementById('sgwMsgPos');if(top.value>-1&&o.scrollHeight>top.value)o.scrollTop=top.value;}sgwQuery(1);}}}}function sgwAjaxStop(dod){var w,p,i;dod=typeof dod!=='undefined'?dod:1;if(sgwAjax[1]){clearTimeout(sgwAjax[1]);sgwAjax[1]=null;}w=document.getElementById('sgwCmd');p=document.getElementById('sgwCmdPos');if(w)p.value=w.scrollTop;w=document.getElementById('sgwMsg');p=document.getElementById('sgwMsgPos');if(w)p.value=w.scrollTop;if(!dod)return;for(i=(w==null?-1:w.childNodes.length-1);i>=0;i--){if(w.childNodes[i].nodeName=='DIV'){w.removeChild(w.childNodes[i]);}}}function sgwAjaxToggle(bid,mid,txt,htxt){var e=document.getElementById(bid);var f=document.getElementById(mid);if(sgwAjax[1]){sgwAjaxStop(0);sgwAjax[3]=e.value;sgwAjax[4]=e.title;e.value=txt;e.title=htxt;f.style.display='';f.style.visibility='visible';}else{e.value=sgwAjax[3];e.title=sgwAjax[4];f.style.visibility='hidden';f.style.display='none';sgwQuery(1);}}